<!doctype html>
    <html lang="en">
        <head>
            <meta charset="utf-8" />
            <title>Diva.js Demo Page</title>
            <link rel="stylesheet" href="/css/diva.min.css" />
            <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
            <![endif]-->
            <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
            <script src="/js/utils.js" type="text/javascript"></script>
            <script src="/js/diva.js" type="text/javascript"></script>
            <script src="/js/plugins/canvas.js" type="text/javascript"></script>
            <script src="/js/plugins/download.js" type="text/javascript"></script>
            <style>
            body, html{
                height:90%;
            }
            #diva-wrapper{
                height:100%;
            }
            .diva-outer{
                height:100%;
            }
            </style>
            <script type="text/javascript">
                /*
                 add this code
                 run console.log( canvas );
                 see the canvas
                 if the canvas is running a webgl context, it'll need the preserveDrawingBuffer flag set to true
                 */

                ( function() {

                    var _oldConsole = console.log;

                    // Code from https://github.com/adriancooney/console.image

                    function getBox(width, height) {
                        return {
                            string: "+",
                            style: "font-size: 1px; padding: " + Math.floor(height/2) + "px " + Math.floor(width/2) + "px; line-height: " + height + "px;"
                        }
                    }

                    function logImage(url, scale) {
                        scale = scale || 1;
                        var img = new Image();

                        img.onload = function() {
                            var dim = getBox(this.width * scale, this.height * scale);
                            console.log("%c" + dim.string, dim.style + "background: url(" + url + "); background-size: " + (this.width * scale) + "px " + (this.height * scale) + "px; color: transparent;");
                        };

                        img.src = url;


                    };

                    console.log = function() {

                        var special = false;

                        [].forEach.call( arguments, function( a ) {
                            if( a instanceof HTMLCanvasElement ) special = true;;
                        } );

                        if( special ) {

                            [].forEach.call( arguments, function( a ) {

                                _oldConsole.apply( console, [ a ] );

                                if( a instanceof HTMLCanvasElement ) {

                                    logImage( a.toDataURL() );

                                }

                            } );

                        } else {

                            _oldConsole.apply( console, arguments );

                        }

                    }

                } )();

                $(document).ready(function() {
                    $('#diva-wrapper').diva({
                        enableAutoHeight: true,
                        fixedHeightGrid: false,
                        iipServerURL: "http://diva.simssa.ca/fcgi-bin/iipsrv.fcgi",
                        objectData: "/demo/beromunster.json",
                        imageDir: "/srv/images/beromunster",
                        enableCanvas: true,
                        enableDownload: true
                    });
                });
            </script>
        </head>
        <body>
            <div id="diva-wrapper"></div>
        </body>
    </html>
