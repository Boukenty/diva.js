Storage.prototype.setObject=function(b,f){this.setItem(b,JSON.stringify(f))};Storage.prototype.getObject=function(b){return(b=this.getItem(b))&&JSON.parse(b)};(function(b){var f=1;b.generateId=function(b){var c;do c=f++ +(b?"-"+b:"");while(document.getElementById(c));return c}})(jQuery);
(function(b){b.getScrollbarWidth=function(){var b=document.createElement("p");b.style.width="100%";b.style.height="200px";var d=document.createElement("div");d.style.position="absolute";d.style.top="0px";d.style.left="0px";d.style.visibility="hidden";d.style.width="200px";d.style.height="150px";d.style.overflow="hidden";d.appendChild(b);document.body.appendChild(d);var c=b.offsetWidth;d.style.overflow="scroll";b=b.offsetWidth;c==b&&(b=d.clientWidth);document.body.removeChild(d);return c-b}})(jQuery);
(function(b){b.getHashParam=function(b){var d=window.location.hash;if(""!==d){var c=0<d.indexOf("&"+b+"=")?d.indexOf("&"+b+"="):d.indexOf("#"+b+"=");if(0<=c)return c+=b.length+2,b=d.indexOf("&",c),b>c?d.substring(c,b):0>b?d.substring(c):""}return!1}})(jQuery);
(function(b){b.updateHashParam=function(f,d){var c=b.getHashParam(f),a=window.location.hash;if(c!==d)if("string"==typeof c){var k=0<a.indexOf("&"+f+"=")?a.indexOf("&"+f+"="):a.indexOf("#"+f+"="),c=k+f.length+2+c.length,g=0===k?"#":"&";window.location.replace(a.substring(0,k)+g+f+"="+d+a.substring(c))}else 0===a.length?window.location.replace("#"+f+"="+d):window.location.replace(a+"&"+f+"="+d)}})(jQuery);
(function(b){b.fn.dragscrollable=function(f){var d=b.extend({dragSelector:">:first",acceptPropagatedEvent:!0,preventDefault:!0},f||{}),c={mouseDownHandler:function(a){if(1!=a.which||!a.data.acceptPropagatedEvent&&a.target!=this)return!1;a.data.lastCoord={left:a.clientX,top:a.clientY};b.event.add(document,"mouseup",c.mouseUpHandler,a.data);b.event.add(document,"mousemove",c.mouseMoveHandler,a.data);if(a.data.preventDefault)return a.preventDefault(),!1},mouseMoveHandler:function(a){var b=a.clientX-
a.data.lastCoord.left,c=a.clientY-a.data.lastCoord.top;a.data.scrollable.scrollLeft(a.data.scrollable.scrollLeft()-b);a.data.scrollable.scrollTop(a.data.scrollable.scrollTop()-c);a.data.lastCoord={left:a.clientX,top:a.clientY};if(a.data.preventDefault)return a.preventDefault(),!1},mouseUpHandler:function(a){b.event.remove(document,"mousemove",c.mouseMoveHandler);b.event.remove(document,"mouseup",c.mouseUpHandler);if(a.data.preventDefault)return a.preventDefault(),!1}};this.each(function(){var a={scrollable:b(this),
acceptPropagatedEvent:d.acceptPropagatedEvent,preventDefault:d.preventDefault};b(this).find(d.dragSelector).bind("mousedown",a,c.mouseDownHandler)})}})(jQuery);
(function(b){var f={cursor:"move",decelerate:!0,triggerHardware:!1,y:!0,x:!0,slowdown:0.9,maxvelocity:40,throttleFPS:60,movingClass:{up:"kinetic-moving-up",down:"kinetic-moving-down",left:"kinetic-moving-left",right:"kinetic-moving-right"},deceleratingClass:{up:"kinetic-decelerating-up",down:"kinetic-decelerating-down",left:"kinetic-decelerating-left",right:"kinetic-decelerating-right"}};window.requestAnimationFrame||(window.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||
window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a,b){window.setTimeout(a,1E3/60)}}());b.support=b.support||{};b.extend(b.support,{touch:"ontouchend"in document});var d=function(){return!1},c=function(a,b){return 0===Math.floor(Math.abs(a))?0:a*b},a=function(a,b){var c=a;0<a?a>b&&(c=b):a<0-b&&(c=0-b);return c},k=function(a,b){this.removeClass(a.movingClass.up).removeClass(a.movingClass.down).removeClass(a.movingClass.left).removeClass(a.movingClass.right).removeClass(a.deceleratingClass.up).removeClass(a.deceleratingClass.down).removeClass(a.deceleratingClass.left).removeClass(a.deceleratingClass.right);
0<a.velocity&&this.addClass(b.right);0>a.velocity&&this.addClass(b.left);0<a.velocityY&&this.addClass(b.down);0>a.velocityY&&this.addClass(b.up)},g=function(a,b){b.velocity=0;b.velocityY=0;b.decelerate=!0;"function"===typeof b.stopped&&b.stopped.call(a,b)},l=function(a,b){var d=a[0];b.x&&0<d.scrollWidth?(d.scrollLeft=b.scrollLeft=d.scrollLeft+b.velocity,0<Math.abs(b.velocity)&&(b.velocity=b.decelerate?c(b.velocity,b.slowdown):b.velocity)):b.velocity=0;b.y&&0<d.scrollHeight?(d.scrollTop=b.scrollTop=
d.scrollTop+b.velocityY,0<Math.abs(b.velocityY)&&(b.velocityY=b.decelerate?c(b.velocityY,b.slowdown):b.velocityY)):b.velocityY=0;k.call(a,b,b.deceleratingClass);"function"===typeof b.moved&&b.moved.call(a,b);0<Math.abs(b.velocity)||0<Math.abs(b.velocityY)?window.requestAnimationFrame(function(){l(a,b)}):g(a,b)},p=function(a,c){var d=b.kinetic.callMethods[a],f=Array.prototype.slice.call(arguments);d&&this.each(function(){var a=f.slice(1),c=b(this).data("kinetic-settings");a.unshift(c);d.apply(this,
a)})},t=function(a,c){b.support.touch?a.bind("touchstart",c.events.touchStart).bind("touchend",c.events.inputEnd).bind("touchmove",c.events.touchMove):a.mousedown(c.events.inputDown).mouseup(c.events.inputEnd).mousemove(c.events.inputMove);a.click(c.events.inputClick).scroll(c.events.scroll).bind("selectstart",d).bind("dragstart",c.events.dragStart)},n=function(c){this.addClass("kinetic-active").each(function(){var d=this,g=b(this);if(!g.data("kinetic-settings")){var m=b.extend({},f,c),n,p=!1,q,v=
!1,w=!1,z=1E3/m.throttleFPS,H,x;m.velocity=0;m.velocityY=0;var u=function(){w=q=n=!1};b(document).mouseup(u).click(u);var F=function(){m.velocity=a(p-n,m.maxvelocity);m.velocityY=a(v-q,m.maxvelocity)},A=function(a){return b.isFunction(m.filterTarget)?!1!==m.filterTarget.call(d,a):!0},r=function(a,c){if(!H||new Date>new Date(H.getTime()+z))H=new Date,w&&(n||q)&&(x&&(b(x).blur(),x=null,g.focus()),m.decelerate=!1,m.velocity=m.velocityY=0,g[0].scrollLeft=m.scrollLeft=m.x?g[0].scrollLeft-(a-n):g[0].scrollLeft,
g[0].scrollTop=m.scrollTop=m.y?g[0].scrollTop-(c-q):g[0].scrollTop,p=n,v=q,n=a,q=c,F(),k.call(g,m,m.movingClass),"function"===typeof m.moved&&m.moved.call(g,m))};m.events={touchStart:function(a){var b;if(A(a.target)){b=a.originalEvent.touches[0];var c=b.clientX;b=b.clientY;w=!0;m.velocity=p=0;m.velocityY=v=0;n=c;q=b;a.stopPropagation()}},touchMove:function(a){var b;w&&(b=a.originalEvent.touches[0],r(b.clientX,b.clientY),a.preventDefault&&a.preventDefault())},inputDown:function(a){if(A(a.target)){var b=
a.clientX,c=a.clientY;w=!0;m.velocity=p=0;m.velocityY=v=0;n=b;q=c;x=a.target;"IMG"===a.target.nodeName&&a.preventDefault();a.stopPropagation()}},inputEnd:function(a){n&&p&&!1===m.decelerate&&(m.decelerate=!0,F(),n=p=w=!1,l(g,m));x=null;a.preventDefault&&a.preventDefault()},inputMove:function(a){w&&(r(a.clientX,a.clientY),a.preventDefault&&a.preventDefault())},scroll:function(a){"function"===typeof m.moved&&m.moved.call(g,m);a.preventDefault&&a.preventDefault()},inputClick:function(a){if(0<Math.abs(m.velocity))return a.preventDefault(),
!1},dragStart:function(a){if(x)return!1}};t(g,m);g.data("kinetic-settings",m).css("cursor",m.cursor);m.triggerHardware&&g.css({"-webkit-transform":"translate3d(0,0,0)","-webkit-perspective":"1000","-webkit-backface-visibility":"hidden"})}})};b.kinetic={settingsKey:"kinetic-settings",callMethods:{start:function(a,c){var d=b(this);if(a=b.extend(a,c))a.decelerate=!1,l(d,a)},end:function(a,c){b(this);a&&(a.decelerate=!0)},stop:function(a,c){var d=b(this);g(d,a)},detach:function(a,c){var f=b(this);b.support.touch?
f.unbind("touchstart",a.events.touchStart).unbind("touchend",a.events.inputEnd).unbind("touchmove",a.events.touchMove):f.unbind("mousedown",a.events.inputDown).unbind("mouseup",a.events.inputEnd).unbind("mousemove",a.events.inputMove).unbind("scroll",a.events.scroll);f.unbind("click",a.events.inputClick).unbind("selectstart",d);f.unbind("dragstart",a.events.dragStart);f.removeClass("kinetic-active").css("cursor","")},attach:function(a,c){var d=b(this);t(d,a);d.addClass("kinetic-active").css("cursor",
"move")}}};b.fn.kinetic=function(a){"string"===typeof a?p.apply(this,arguments):n.call(this,a);return this}})(window.jQuery||window.Zepto);var diva=function(){var b={};return{Events:{publish:function(f,d,c){if(b[f]){f=b[f];for(var a=f.length;a--;)f[a].apply(c||this,d||[])}},subscribe:function(f,d){b[f]||(b[f]=[]);b[f].push(d);return[f,d]},unsubscribe:function(f,d){var c=f[0],a=b[c].length;if(b[c])for(;a--;)b[c][a]===f[1]&&(b[c].splice(a,1),d&&delete b[c])},unsubscribeAll:function(){b={}}}}}();window.divaPlugins=[];
(function(b){var f=function(d,c){var a=b.extend({},{adaptivePadding:0.05,arrowScrollAmount:40,blockMobileMove:!0,objectData:"",enableAutoHeight:!1,enableAutoTitle:!0,enableAutoWidth:!0,enableCanvas:!0,enableDownload:!0,enableFilename:!0,enableFullscreen:!0,enableGotoPage:!0,enableGridIcon:!0,enableGridControls:"buttons",enableKeyScroll:!0,enableLinkIcon:!0,enableSpaceScroll:!1,enableToolbar:!0,enableZoomControls:"buttons",fixedPadding:10,fixedHeightGrid:!0,goDirectlyTo:0,iipServerURL:"",inFullscreen:!1,
inGrid:!1,imageDir:"",maxPagesPerRow:8,maxZoomLevel:-1,minPagesPerRow:2,minZoomLevel:0,onDocumentLoaded:null,onModeToggle:null,onViewToggle:null,onJump:null,onPageLoad:null,onPageLoaded:null,onReady:null,onScroll:null,onScrollDown:null,onScrollUp:null,onSetCurrentPage:null,onZoom:null,onZoomIn:null,onZoomOut:null,pageLoadTimeout:200,pagesPerRow:5,rowLoadTimeout:50,throbberTimeout:100,tileHeight:256,tileWidth:256,toolbarParentSelector:null,verticallyOriented:!0,viewerHeightPadding:15,viewerWidthPadding:30,
viewportMargin:200,zoomLevel:2},c);b.extend(a,{allTilesLoaded:[],averageHeights:[],averageWidths:[],currentPageIndex:0,divaIsFullWindow:!1,doubleClickZoom:!1,firstPageLoaded:-1,firstRowLoaded:-1,gridPageWidth:0,hashParamSuffix:"",heightProportion:0,horizontalOffset:0,horizontalPadding:0,ID:null,innerSelector:"",itemTitle:"",lastPageLoaded:-1,lastRowLoaded:-1,loaded:!1,maxWidths:[],maxHeights:[],maxRatio:0,minHeight:0,minRatio:0,minWidth:0,mobileWebkit:!1,numPages:0,numRows:0,oldPagesPerRow:0,oldZoomLevel:-1,
orientationChange:!1,outerSelector:"",pages:[],pageLeftOffsets:[],pageTopOffsets:[],pageTimeouts:[],pageTools:"",panelHeight:0,panelWidth:0,plugins:[],previousLeftScroll:0,previousTopScroll:0,realMaxZoom:-1,resizeTimer:-1,rowHeight:0,scaleWait:!1,selector:"",singleClick:!1,isScrollable:!0,initialKeyScroll:!1,initialSpaceScroll:!1,scrollbarWidth:0,throbberTimeoutID:-1,toolbar:null,totalHeights:[],totalHeight:0,totalWidths:[],totalWidth:0,verticalOffset:0,verticalPadding:0,widthProportion:0,viewerXOffset:0,
viewerYOffset:0});var f=this,g=function(a){var b=!0;return function(a){var h,c,d;if("function"===typeof a){h=[];c=1;for(d=arguments.length;c<d;c++)h.push(arguments[c]);b&&(console.warn('The use of callback functions is deprecated. Use diva.Events.subscribe("Event", function) instead.'),b=!1);a.apply(f,h);return!0}return!1}}(),l=function(b,e){return a.pages[b].d[a.zoomLevel][e]},p=function(b){var e,c=a.numPages;for(e=0;e<c;e++)if(a.pages[e].f===b)return e;return-1},t=function(b,e){var c=a.panelWidth,
d=document.getElementById(a.ID+"outer").scrollLeft-a.viewportMargin,c=d+c+2*a.viewportMargin;return b>=d&&b<=c||b<=d&&e>=c||e>=d&&e<=c},n=function(b,e){var c=a.panelHeight,d=document.getElementById(a.ID+"outer").scrollTop-a.viewportMargin,c=d+c+2*a.viewportMargin;return b>=d&&b<=c||b<=d&&e>=c||e>=d&&e<=c},s=function(b){return 0<=b&&b<a.numPages},y=function(b){var e=a.pageTopOffsets[b],c=e+l(b,"h")+a.verticalPadding,d=a.pageLeftOffsets[b];b=d+l(b,"w")+a.horizontalPadding;return n(e,c)&&t(d,b)},L=function(h){if(!document.getElementById(a.ID+
"page-"+h)||!a.allTilesLoaded[h]){var e=a.pages[h].f,c=l(h,"w"),d=l(h,"h"),f=a.pageTopOffsets[h]+a.verticalPadding,k=a.pageLeftOffsets[h]+a.horizontalPadding,u=a.selector+"page-"+h,r;if(!document.getElementById(a.ID+"page-"+h))for(r in a.verticallyOriented?b(document.getElementById(a.ID+"inner")).append('<div id="'+a.ID+"page-"+h+'" style="top: '+f+"px; width: "+c+"px; height: "+d+'px;" class="diva-document-page diva-page-vertical" title="Page '+(h+1)+'" data-index="'+h+'" data-filename="'+e+'">'+
a.pageTools+"</div>"):b(document.getElementById(a.ID+"inner")).append('<div id="'+a.ID+"page-"+h+'" style="left: '+k+"px; width: "+c+"px; height: "+d+'px;" class="diva-document-page diva-page-horizontal" title="Page '+(h+1)+'" data-index="'+h+'" data-filename="'+e+'">'+a.pageTools+"</div>"),g(a.onPageLoad,h,e,u),diva.Events.publish("PageWillLoad",[h,e,u]),a.plugins)g(a.plugins[r].onPageLoad,h,e,u);a.pageTimeouts.push(setTimeout(function(){if(y(h)){var f=a.imageDir+"/",k=l(h,"r"),r=l(h,"c"),A=[],m=
!0,F=0,ja=d-(k-1)*a.tileHeight,G=c-(r-1)*a.tileWidth,D,R,p,q,J,Z;baseImageURL=a.iipServerURL+"?FIF="+f+e+"&JTL="+(a.zoomLevel+a.pages[h].m-a.realMaxZoom)+",";for(f=0;f<k;){for(D=0;D<r;){q=f*a.tileHeight;J=D*a.tileWidth;R=f===k-1?ja:a.tileHeight;p=D===r-1?G:a.tileWidth;Z=baseImageURL+F;if(!document.getElementById(a.ID+"tile-"+h+"-"+F)){var I=void 0,s=void 0;a.verticallyOriented?(I=a.pageTopOffsets[h]+f*a.tileHeight+a.verticalPadding,s=a.pageLeftOffsets[h]+D*a.tileWidth):(I=a.pageTopOffsets[h]+f*a.tileHeight,
s=a.pageLeftOffsets[h]+D*a.tileWidth+a.horizontalPadding);var w=s+a.tileWidth;n(I,I+a.tileHeight)&&t(s,w)?A.push('<div id="'+a.ID+"tile-"+h+"-"+F+'" class="diva-document-tile" style="display:inline; position: absolute; top: '+q+"px; left: "+J+"px; background-image: url('"+Z+"'); height: "+R+"px; width: "+p+'px;"></div>'):m=!1}F++;D++}f++}a.allTilesLoaded[h]=m;b(document.getElementById(a.ID+"page-"+h)).append(A.join(""));g(a.onPageLoaded,h,e,u);diva.Events.publish("PageDidLoad",[h,e,u])}},a.pageLoadTimeout))}},
m=function(h){b(document.getElementById(a.ID+"page-"+h)).empty().remove()},O=function(b){if(a.verticallyOriented){b=a.pageTopOffsets[b]+l(b,"h")+a.verticalPadding;var e=document.getElementById(a.ID+"outer").scrollTop}else b=a.pageLeftOffsets[b]+l(b,"w")+a.horizontalPadding,e=document.getElementById(a.ID+"outer").scrollLeft;return b=b<e},K=function(b){if(a.verticallyOriented){b=a.pageTopOffsets[b];var e=document.getElementById(a.ID+"outer").scrollTop+a.panelHeight}else b=a.pageLeftOffsets[b],e=document.getElementById(a.ID+
"outer").scrollLeft+a.panelWidth;return b=b>e},q=function(b,e){0<e?s(b)&&(y(b)?(L(b),a.lastPageLoaded=b,q(a.lastPageLoaded+1,e)):O(b)&&q(b+1,e)):s(b)&&(y(b)?(L(b),a.firstPageLoaded=b,q(a.firstPageLoaded-1,e)):K(b)&&q(b-1,e))},v=function(b,e){0<e?s(b)&&O(b)&&(m(b),a.firstPageLoaded=b+1,v(a.firstPageLoaded,e)):s(b)&&K(b)&&(m(b),a.lastPageLoaded=b-1,v(a.lastPageLoaded,e))},w=function(b){return 0<=b&&b<a.numRows},z=function(b){b*=a.rowHeight;return n(b,b+a.rowHeight+a.fixedPadding)},H=function(h){if(!(0<
b(a.selector+"row-"+h).length)){var e=[];e.push('<div class="diva-row" id="'+a.ID+"row-"+h+'" style="height: '+a.rowHeight+"; top: "+(a.rowHeight*h+a.fixedPadding)+'px;">');var c,d,f,k,u,g,r=a.imageDir+"/",F=a.pagesPerRow;for(c=0;c<F;c++){d=h*a.pagesPerRow+c;if(!s(d))break;f=a.pages[d].f;k=l(d,"w");u=l(d,"h");g=a.fixedHeightGrid?(a.rowHeight-a.fixedPadding)*k/u:a.gridPageWidth;k=a.fixedHeightGrid?a.rowHeight-a.fixedPadding:g/k*u;u=parseInt(c*(a.fixedPadding+a.gridPageWidth)+a.fixedPadding,10);g=parseInt(g,
10);k=parseInt(k,10);u+=a.fixedHeightGrid?(a.gridPageWidth-g)/2:0;f=a.iipServerURL+"?FIF="+r+f+"&amp;HEI="+(k+2)+"&amp;CVT=JPEG";e.push('<div id="'+a.ID+"page-"+d+'" class="diva-page" style="width: '+g+"px; height: "+k+"px; left: "+u+'px;" title="Page '+(d+1)+'"></div>');R(h,d,f,g,k)}e.push("</div>");b(document.getElementById(a.ID+"inner")).append(e.join(""))}},x=function(h){b(document.getElementById(a.ID+"row-"+h)).empty().remove()},u=function(b){b=a.rowHeight*(b+1);var e=document.getElementById(a.ID+
"outer").scrollTop;return b<e},F=function(b){b*=a.rowHeight;var e=document.getElementById(a.ID+"outer").scrollTop+a.panelHeight;return b>e},A=function(b,e){0<e?w(b)&&(z(b)?(H(b),a.lastRowLoaded=b,A(a.lastRowLoaded+1,e)):u(b)&&A(b+1,e)):w(b)&&(z(b)?(H(b),a.firstRowLoaded=b,A(a.firstRowLoaded-1,e)):F(b)&&A(b-1,e))},r=function(b,e){0<e?w(b)&&u(b)&&(x(b),a.firstRowLoaded++,r(a.firstRowLoaded,e)):w(b)&&F(b)&&(x(b),a.lastRowLoaded--,r(a.lastRowLoaded,e))},R=function(h,e,c,d,f){a.pageTimeouts.push(setTimeout(function(){z(h)&&
b(a.selector+"page-"+e).html('<img src="'+c+'" style="width: '+d+"px; height: "+f+'px;" />')},a.rowLoadTimeout))},D=function(b){var e=(a.verticallyOriented?document.getElementById(a.ID+"outer").scrollTop:document.getElementById(a.ID+"outer").scrollLeft)+a.panelWidth/2,c=a.currentPageIndex,d=c+b,f=!1;0>b?a.verticallyOriented?0<=d&&a.pageTopOffsets[d]+l(d,"h")+a.verticalPadding>=e&&(f=!0):0<=d&&a.pageLeftOffsets[d]+l(d,"w")+a.horizontalPadding>=e&&(f=!0):0<b&&(a.verticallyOriented?a.pageTopOffsets[c]+
l(c,"h")+a.verticalPadding<e&&(f=!0):a.pageLeftOffsets[c]+l(c,"w")+a.horizontalPadding<e&&(f=!0));return f?(a.currentPageIndex=d,0===b||D(b)||(b=a.pages[d].f,g(a.onSetCurrentPage,d,b),diva.Events.publish("VisiblePageDidChange",[d,b])),!0):!1},J=function(b){var e=Math.floor(a.currentPageIndex/a.pagesPerRow),c=e+parseInt(b,10),d=document.getElementById(a.ID+"outer").scrollTop,f=d+a.panelHeight/2,k=!1;0>b?0<=c&&(a.rowHeight*e>=f||a.rowHeight*c>=d)&&(k=!0):0<b&&a.rowHeight*(e+1)<d&&w(c)&&(k=!0);return k?
(a.currentPageIndex=c*a.pagesPerRow,0===b||J(b)||(b=a.currentPageIndex,diva.Events.publish("VisiblePageDidChange",[b,a.pages[b].f])),!0):!1},S=function(a){var b=P(!1),c=Q(!1);G(a,b,c)},G=function(h,e,c){c="undefined"!==typeof c?c:0;e=(a.pageTopOffsets[h]||a.verticalPadding)+("undefined"!==typeof e?e:0)-b(a.outerSelector).height()/2;c=(a.pageLeftOffsets[h]||a.horizontalPadding)+c-b(a.outerSelector).width()/2;b(a.outerSelector).scrollTop(e);b(a.outerSelector).scrollLeft(c);a.currentPageIndex=h;c=a.pages[h].f;
g(a.onSetCurrentPage,h,c);diva.Events.publish("VisiblePageDidChange",[h,c]);g(a.onJump,h);diva.Events.publish("ViewerDidJump",[h])},I=function(h){var e=Math.floor(h/a.pagesPerRow)*a.rowHeight;b(a.outerSelector).scrollTop(e);a.currentPageIndex=h;diva.Events.publish("VisiblePageDidChange",[h,a.pages[h].f])},U=function(b){return b>=a.minZoomLevel&&b<=a.maxZoomLevel?b:a.minZoomLevel},$=function(b){return b>=a.minPagesPerRow&&b<=a.maxPagesPerRow?b:a.maxPagesPerRow},aa=function(){a.allTilesLoaded=[];b(a.outerSelector).scrollTop(0);
b(a.innerSelector).empty();a.firstPageLoaded=0;a.firstRowLoaded=-1;a.previousTopScroll=0;a.previousLeftScroll=0;for(clearTimeout(a.resizeTimer);a.pageTimeouts.length;)clearTimeout(a.pageTimeouts.pop())},N=function(){a.inGrid?ba():ca()},ca=function(){aa();a.zoomLevel=U(a.zoomLevel);var h=a.zoomLevel;0<a.adaptivePadding?(a.horizontalPadding=a.averageWidths[h]*a.adaptivePadding,a.verticalPadding=a.averageHeights[h]*a.adaptivePadding):(a.horizontalPadding=a.fixedPadding,a.verticalPadding=a.fixedPadding);
a.pageTools.length&&(a.verticallyOriented?a.verticalPadding=Math.max(40,a.horizontalPadding):a.horizontalPadding=Math.max(40,a.verticalPadding));a.totalHeight=a.totalHeights[h]+a.verticalPadding*(a.numPages+1);a.totalWidth=a.totalWidths[h]+a.horizontalPadding*(a.numPages+1);var e=a.maxHeights[h]+2*a.verticalPadding,c=Math.max(a.maxWidths[h]+2*a.horizontalPadding,a.panelWidth),d=Math.max(e,a.panelHeight);a.verticallyOriented?(b(a.innerSelector).height(Math.round(a.totalHeight)),b(a.innerSelector).width(Math.round(c))):
(b(a.innerSelector).height(Math.round(d)),b(a.innerSelector).width(Math.round(a.totalWidth)));for(var f=0,k=0,e=0;e<a.numPages;e++)a.pageTopOffsets[e]=a.verticallyOriented?f:(d-l(e,"h"))/2,a.pageLeftOffsets[e]=a.verticallyOriented?(c-l(e,"w"))/2:k,f=a.pageTopOffsets[e]+l(e,"h")+a.verticalPadding,k=a.pageLeftOffsets[e]+l(e,"w")+a.horizontalPadding;s(a.goDirectlyTo)||(a.goDirectlyTo=0);G(a.goDirectlyTo,a.verticalOffset,a.horizontalOffset);c=!1;for(e=0;e<a.numPages;e++)if(y(e))L(e),a.lastPageLoaded=
e,c=!0;else if(c)break;0<=a.oldZoomLevel?(a.oldZoomLevel<a.zoomLevel?(g(a.onZoomIn,h),diva.Events.publish("ViewerDidZoomIn",h)):(g(a.onZoomOut,h),diva.Events.publish("ViewerDidZoomOut",h)),g(a.onZoom,h)):a.oldZoomLevel=a.zoomLevel;a.scaleWait&&(a.scaleWait=!1);h=a.pages[a.currentPageIndex].f;g(a.onDocumentLoaded,a.lastPageLoaded,h);diva.Events.publish("DocumentDidLoad",[a.lastPageLoaded,h])},ba=function(){var c=a.currentPageIndex;a.verticalOffset=a.verticallyOriented?a.panelHeight/2:l(c,"h")/2;a.horizontalOffset=
a.verticallyOriented?l(c,"w")/2:a.panelWidth/2;aa();a.pagesPerRow=$(a.pagesPerRow);c=(a.panelWidth-a.fixedPadding*(a.pagesPerRow+1))/a.pagesPerRow;a.gridPageWidth=c;a.rowHeight=a.fixedHeightGrid?a.fixedPadding+a.minRatio*c:a.fixedPadding+a.maxRatio*c;a.numRows=Math.ceil(a.numPages/a.pagesPerRow);a.totalHeight=a.numRows*a.rowHeight+a.fixedPadding;b(a.innerSelector).height(Math.round(a.totalHeight));b(a.innerSelector).width(Math.round(a.panelWidth));I(a.goDirectlyTo);for(var e,d=a.numPages,c=0;c<d;c+=
a.pagesPerRow)e=Math.floor(c/a.pagesPerRow),z(e)&&(a.firstRowLoaded=0>a.firstRowLoaded?e:a.firstRowLoaded,H(e),a.lastRowLoaded=e)},X=function(c){0<=a.oldZoomLevel&&!a.inGrid&&(a.verticalOffset=P(!1),a.horizontalOffset=Q(!1));b(a.outerSelector).toggleClass("diva-fullscreen");b("body").toggleClass("diva-hide-scrollbar");b(a.parentSelector).toggleClass("diva-full-width");var e=a.mobileWebkit?parseInt(b("body").css("margin")):0,e=a.inFullscreen?"0px":a.enableAutoWidth?(a.viewerWidthPadding-e).toString()+
"px":"";b(a.outerSelector).css("margin-left",e);a.panelHeight=b(a.outerSelector).height();a.panelWidth=b(a.outerSelector).width()-a.scrollbarWidth;b(a.innerSelector).width(a.panelWidth);a.viewerXOffset=b(a.outerSelector).offset().left;a.viewerYOffset=b(a.outerSelector).offset().top;c?(a.inGrid=!a.inGrid,B()):N();a.inFullscreen||(a.mobileWebkit?V():W());g(a.onModeToggle,a.inFullscreen);diva.Events.publish("ModeDidSwitch",[a.inFullscreen])},B=function(){N();g(a.onViewToggle,a.inGrid);diva.Events.publish("ViewDidSwitch",
[a.inGrid])},E=function(){a.goDirectlyTo=a.currentPageIndex;a.inFullscreen=!a.inFullscreen;X(!1)},C=function(){a.goDirectlyTo=a.currentPageIndex;a.inGrid=!a.inGrid;B()},da=function(c){var e=b(this).offset();a.doubleClickZoom=!0;a.horizontalOffset=c.pageX-e.left;a.verticalOffset=c.pageY-e.top;a.goDirectlyTo=parseInt(b(this).attr("data-index"),10);M(c.ctrlKey?a.zoomLevel-1:a.zoomLevel+1)},M=function(b){var e=U(b);if(e!==b)return!1;b=Math.pow(2,e-a.zoomLevel);a.doubleClickZoom?(a.verticalOffset*=b,a.horizontalOffset*=
b,a.doubleClickZoom=!1):(a.goDirectlyTo=a.currentPageIndex,a.verticalOffset=b*P(!0),a.horizontalOffset=b*Q(!0));a.oldZoomLevel=a.zoomLevel;a.zoomLevel=e;diva.Events.publish("ZoomLevelDidChange",null);ca();return!0},T=function(b){var e=$(b);if(e!==b)return!1;a.oldPagesPerRow=a.zoomLevel;a.pagesPerRow=e;diva.Events.publish("GridRowNumberDidChange",null);a.goDirectlyTo=a.currentPageIndex;ba();return!0},P=function(b){var e;e=a.currentPageIndex;b?(b=document.getElementById(a.ID+"outer"),e=b.scrollTop-
a.pageTopOffsets[e]+b.offsetHeight/2):e=a.verticallyOriented?a.panelHeight/2:l(e,"h")/2;return parseInt(e,10)},Q=function(b){var e;e=a.currentPageIndex;b?(b=document.getElementById(a.ID+"outer"),e=b.scrollLeft-a.pageLeftOffsets[e]+b.offsetWidth):e=a.verticallyOriented?l(e,"w")/2:a.panelWidth/2;return parseInt(e,10)},ea=function(){return{f:a.inFullscreen,g:a.inGrid,z:a.zoomLevel,n:a.pagesPerRow,i:a.enableFilename?a.pages[a.currentPageIndex].f:!1,p:a.enableFilename?!1:a.currentPageIndex+1,y:a.inGrid?
!1:P(!0),x:a.inGrid?!1:Q(!0)}},fa=function(){var b=ea(),e=[],c;for(c in b)!1!==b[c]&&e.push(c+a.hashParamSuffix+"="+b[c]);return e.join("&")},ga=function(){return location.protocol+"//"+location.host+location.pathname+"#"+fa()},V=function(){a.viewerXOffset=b(a.outerSelector).offset().left;a.viewerYOffset=b(a.outerSelector).offset().top;a.panelHeight=window.innerHeight-a.viewerYOffset-a.viewerHeightPadding;a.panelWidth=a.enableAutoWidth?window.innerWidth-2*a.viewerWidthPadding:window.innerWidth;a.enableAutoHeight&&
(document.getElementById(a.ID+"outer").style.height=a.panelHeight+"px");a.enableAutoWidth&&(document.getElementById(a.ID+"outer").style.width=a.panelWidth+"px")},W=function(){var c,e;a.divaIsFullWindow?(e=b(window).innerWidth(),c=b(window).innerHeight()):(e=b(a.parentSelector).parent().innerWidth(),c=b(a.parentSelector).parent().innerHeight());a.enableAutoHeight&&b(a.parentSelector).height(c*a.heightProportion);a.enableAutoWidth&&b(a.parentSelector).width(e*a.widthProportion);c=b(a.outerSelector).offset();
a.viewerXOffset=c.left;a.viewerYOffset=c.top;e=parseInt(b(a.outerSelector).css("border-top-width"))+parseInt(b(a.outerSelector).css("border-bottom-width"));c=b(a.parentSelector).height();var d=b(a.parentSelector).offset().top;c=a.enableAutoHeight?c-a.viewerYOffset+d-e:b(a.outerSelector).height();d=parseInt(b(a.outerSelector).css("border-left-width"))+parseInt(b(a.outerSelector).css("border-right-width"));e=b(a.parentSelector).width();e=a.enableAutoWidth?e-2*a.viewerWidthPadding-d-a.scrollbarWidth:
b(a.outerSelector).width()-a.scrollbarWidth-d;return e!==a.panelWidth||c!==a.panelHeight?(a.enableAutoHeight&&b(a.outerSelector).height(c),a.enableAutoWidth&&b(a.outerSelector).width(e+a.scrollbarWidth),a.panelWidth=e,a.panelHeight=c,!0):!1},ha=function(){a.mobileWebkit||b(a.outerSelector+", "+a.innerSelector).dragscrollable({dragSelector:".diva-dragger",acceptPropagatedEvent:!0});b(a.outerSelector).on("dblclick",".diva-document-page",function(a){da.call(this,a)});b(a.outerSelector).on("contextmenu",
".diva-document-page",function(b){if(b.ctrlKey)return clearTimeout(a.singleClickTimeout),a.singleClick?(da.call(this,b),a.singleClick=!1):(a.singleClick=!0,a.singleClickTimeout=setTimeout(function(){a.singleClick=!1},500)),!1});b(a.outerSelector).on("dblclick",".diva-row",function(b){var e=document.getElementById(a.ID+"outer");a.goDirectlyTo=Math.floor((b.pageY-a.viewerYOffset+e.scrollTop)/a.rowHeight)*a.pagesPerRow+Math.floor((b.pageX-a.viewerXOffset+e.scrollLeft)/(a.panelWidth/a.pagesPerRow));a.inGrid=
!1;B()})},ka=function(){b(a.innerSelector).mouseover(function(){b(this).removeClass("diva-grabbing").addClass("diva-grab")});b(a.innerSelector).mouseout(function(){b(this).removeClass("diva-grab")});b(a.innerSelector).mousedown(function(){b(this).removeClass("diva-grab").addClass("diva-grabbing")});b(a.innerSelector).mouseup(function(){b(this).removeClass("diva-grabbing").addClass("diva-grab")});ha();b(a.outerSelector).scroll(function(){var b,c=document.getElementById(a.ID+"outer").scrollTop,d=document.getElementById(a.ID+
"outer").scrollLeft;b=a.verticallyOriented||a.inGrid?c-a.previousTopScroll:d-a.previousLeftScroll;if(a.inGrid){0>b?(A(a.firstRowLoaded,-1),J(-1),r(a.lastRowLoaded,-1)):0<b&&(A(a.lastRowLoaded,1),J(1),r(a.firstRowLoaded,1));var h=document.getElementById(a.ID+"outer").scrollTop;g(a.onScroll,h);diva.Events.publish("ViewerDidScroll",[h])}else{if(0>b)q(a.firstPageLoaded,b),D(-1),v(a.lastPageLoaded,b);else if(0<b)q(a.lastPageLoaded,b),D(1),v(a.firstPageLoaded,b);else for(var f=a.lastPageLoaded,h=Math.max(a.firstPageLoaded,
0);h<=f;h++)y(h)&&L(h);h=a.verticallyOriented?document.getElementById(a.ID+"outer").scrollTop:document.getElementById(a.ID+"outer").scrollLeft;g(a.onScroll,h);diva.Events.publish("ViewerDidScroll",h)}0<b?(g(a.onScrollDown,h),diva.Events.publish("ViewerDidScrollDown",[h])):0>b&&(g(a.onScrollUp,h),diva.Events.publish("ViewerDidScrollUp",[h]));a.previousTopScroll=c;a.previousLeftScroll=d});if(a.mobileWebkit){var c=[];c.push('<meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1" />');
c.push('<meta name="apple-mobile-web-app-capable" content="yes" />');c.push('<meta name="apple-mobile-web-app-status-bar-style" content="black" />');b("head").append(c.join("\n"));a.blockMobileMove&&b("body").bind("touchmove",function(a){a.originalEvent.preventDefault();return!1});b("body").bind("gestureend",function(b){b=b.originalEvent;if(!a.scaleWait)if(a.goDirectlyTo=a.currentPageIndex,a.inGrid)a.inGrid=!1,B();else a:{var c=a.zoomLevel;if(1<b.scale&&c<a.maxZoomLevel)c++;else if(1>b.scale&&c>a.minZoomLevel)c--;
else break a;a.scaleWait=!0;M(c)}return!1});b(window).bind("orientationchange",function(b){a.orientationChange=!0;V();a.goDirectlyTo=a.currentPageIndex;N()});b(a.outerSelector).kinetic({triggerHardware:!0,filterTarget:function(a){return"diva-canvas-icon"===a.className||"diva-download-icon"===a.className?!1:!0}})}if(a.enableSpaceScroll||a.enableKeyScroll)b(document).keydown(function(c){if(a.enableSpaceScroll&&32===c.keyCode||a.enableKeyScroll&&34===c.keyCode)return b(a.outerSelector).scrollTop(document.getElementById(a.ID+
"outer").scrollTop+a.panelHeight),!1;if(a.enableKeyScroll&&33===c.keyCode)return b(a.outerSelector).scrollTop(document.getElementById(a.ID+"outer").scrollTop-a.panelHeight),!1;if(a.enableKeyScroll&&38===c.keyCode)return b(a.outerSelector).scrollTop(document.getElementById(a.ID+"outer").scrollTop-a.arrowScrollAmount),!1;if(a.enableKeyScroll&&40===c.keyCode)return b(a.outerSelector).scrollTop(document.getElementById(a.ID+"outer").scrollTop+a.arrowScrollAmount),!1;if(a.enableKeyScroll&&37===c.keyCode)return b(a.outerSelector).scrollLeft(document.getElementById(a.ID+
"outer").scrollLeft-a.arrowScrollAmount),!1;if(a.enableKeyScroll&&39===c.keyCode)return b(a.outerSelector).scrollLeft(document.getElementById(a.ID+"outer").scrollLeft+a.arrowScrollAmount),!1;if(a.enableKeyScroll&&36===c.keyCode)return b(a.outerSelector).scrollTop(0),!1;if(a.enableKeyScroll&&35===c.keyCode)return b(a.outerSelector).scrollTop(a.totalHeight),!1}),a.mobileWebkit||b(window).resize(function(){var b;a.inFullscreen?(a.panelWidth=window.innerWidth-a.scrollbarWidth,a.panelHeight=window.innerHeight,
b=!0):b=W();b&&(clearTimeout(a.resizeTimer),a.resizeTimer=setTimeout(function(){a.goDirectlyTo=a.currentPageIndex;N()},200))})},la=function(){var c='<div id="'+a.ID+'tools-left" class="diva-tools-left">'+("slider"===a.enableZoomControls?'<input type="range" id="'+a.ID+'zoom-slider" class="zoom-slider" value="'+a.zoomLevel+'" min="'+a.minZoomLevel+'" max="'+a.maxZoomLevel+'">':"")+("buttons"===a.enableZoomControls?'<div id="'+a.ID+'zoom-out-button" class="diva-zoom-out-button button" title="Zoom Out"></div><div id="'+
a.ID+'zoom-in-button" class="diva-zoom-in-button button" title="Zoom In"></div>':"")+("slider"===a.enableGridControls?'<input type="range" id="'+a.ID+'grid-slider" class="grid-slider" value="'+a.pagesPerRow+'" min="'+a.minPagesPerRow+'" max="'+a.maxPagesPerRow+'">':"")+("buttons"===a.enableGridControls?'<div id="'+a.ID+'grid-out-button" class="diva-grid-out-button button" title="Zoom Out"></div><div id="'+a.ID+'grid-in-button" class="diva-grid-in-button button" title="Zoom In"></div>':"")+("slider"===
a.enableZoomControls?'<div id="'+a.ID+'zoom-slider-label" class="diva-slider-label">Zoom level: <span id="'+a.ID+'zoom-level">'+a.zoomLevel+"</span></div>":"")+("buttons"===a.enableZoomControls?'<div id="'+a.ID+'zoom-buttons-label" class="diva-buttons-label">Zoom level: <span id="'+a.ID+'zoom-level">'+a.zoomLevel+"</span></div>":"")+("slider"===a.enableGridControls?'<div id="'+a.ID+'grid-slider-label" class="diva-slider-label">Pages per row: <span id="'+a.ID+'pages-per-row">'+a.pagesPerRow+"</span></div>":
"")+("buttons"===a.enableGridControls?'<div id="'+a.ID+'grid-buttons-label" class="diva-buttons-label">Pages per row: <span id="'+a.ID+'pages-per-row">'+a.pagesPerRow+"</span></div>":"")+'</div><div id="'+a.ID+'tools-right" class="diva-tools-right">'+(a.enableFullscreen?'<div id="'+a.ID+'fullscreen" class="diva-fullscreen-icon button" title="Toggle fullscreen mode"></div>':"")+(a.enableLinkIcon?'<div class="diva-link-icon button" id="'+a.ID+'link-icon" style="'+(a.enableGridIcon?"border-left: 0px":
"")+'" title="Link to this page"></div>':"")+(a.enableGridIcon?'<div class="diva-grid-icon button'+(a.inGrid?" diva-in-grid":"")+'" id="'+a.ID+'grid-icon" title="Toggle grid view"></div>':"")+'<div class="diva-page-nav">'+(a.enableGotoPage?'<form id="'+a.ID+'goto-page" class="diva-goto-form"><input type="text" id="'+a.ID+'goto-page-input" / class="diva-input"> <input type="submit" value="Go" style="margin-top: 0px;" /></form>':"")+('<div class="diva-page-label">Page <span id="'+a.ID+'current-page">1</span> of <span id="'+
a.ID+'num-pages">'+a.numPages+"</span></div>")+"</div></div>";a.toolbarParentSelector?b(a.toolbarParentSelector).prepend('<div id="'+a.ID+'tools" class="diva-tools">'+c+"</div>"):b(a.parentSelector).prepend('<div id="'+a.ID+'tools" class="diva-tools">'+c+"</div>");b(a.selector+"zoom-slider").on("input",function(a){a=parseInt(this.value,10);M(a)});b(a.selector+"zoom-slider").on("change",function(b){b=parseInt(this.value,10);b!==a.zoomLevel&&M(b)});b(a.selector+"zoom-out-button").click(function(){M(a.zoomLevel+
-1)});b(a.selector+"zoom-in-button").click(function(){M(a.zoomLevel+1)});b(a.selector+"grid-slider").on("input",function(a){a=parseInt(this.value,10);T(a)});b(a.selector+"grid-slider").on("change",function(b){b=parseInt(this.value,10);b!==a.zoomLevel&&T(b)});b(a.selector+"fullscreen").click(function(){E()});b(a.selector+"grid-out-button").click(function(){T(a.pagesPerRow-1)});b(a.selector+"grid-in-button").click(function(){T(a.pagesPerRow+1)});b(a.selector+"grid-icon").click(function(){C()});b(a.selector+
"goto-page").submit(function(){var c=parseInt(b(a.selector+"goto-page-input").val(),10)-1;s(c)?a.inGrid?I(c):S(c):alert("Invalid page number");return!1});b(a.selector+"link-icon").click(function(){b("body").prepend('<div id="'+a.ID+'link-popup" class="diva-link-popup"><input id="'+a.ID+'link-popup-input" class="diva-input" type="text" value="'+ga()+'"/></div>');if(a.inFullscreen)b(a.selector+"link-popup").addClass("in-fullscreen");else{var c=b(a.outerSelector).offset().left+a.panelWidth,c=c+(a.scrollbarWidth-
240-1),e=b(a.outerSelector).offset().top+1;b(a.selector+"link-popup").removeClass("in-fullscreen").css({top:e+"px",left:c+"px"})}b("body").mouseup(function(c){c=c.target.id;c!==a.ID+"link-popup"&&c!==a.ID+"link-popup-input"&&b(a.selector+"link-popup").remove()});b(a.outerSelector).scroll(function(){b(a.selector+"link-popup").remove()});b(a.selector+"link-popup input").click(function(){b(this).focus().select()});return!1});var e=a.inGrid?"grid":"zoom";b(a.selector+e+"-slider").show();b(a.selector+
e+"-out-button").show();b(a.selector+e+"-in-button").show();b(a.selector+e+"-slider-label").show();b(a.selector+e+"-buttons-label").show();return{updateCurrentPage:function(){b(a.selector+"current-page").text(a.currentPageIndex+1)},setNumPages:function(c){b(a.selector+"num-pages").text(c)},updateZoomSlider:function(){a.zoomLevel!==b(a.selector+"zoom-slider").val()&&b(a.selector+"zoom-slider").val(a.zoomLevel);b(a.selector+"zoom-level").text(a.zoomLevel)},updateZoomButtons:function(){b(a.selector+
"zoom-level").text(a.zoomLevel)},updateGridSlider:function(){a.pagesPerRow!==b(a.selector+"grid-slider").val()&&b(a.selector+"grid-slider").val(a.pagesPerRow);b(a.selector+"pages-per-row").text(a.pagesPerRow)},updateGridButtons:function(){b(a.selector+"pages-per-row").text(a.pagesPerRow)},switchView:function(){b(a.selector+e+"-slider").hide();b(a.selector+e+"-out-button").hide();b(a.selector+e+"-in-button").hide();b(a.selector+e+"-slider-label").hide();b(a.selector+e+"-buttons-label").hide();e=a.inGrid?
"grid":"zoom";b(a.selector+e+"-slider").show();b(a.selector+e+"-out-button").show();b(a.selector+e+"-in-button").show();b(a.selector+e+"-slider-label").show();b(a.selector+e+"-buttons-label").show();b(a.selector+"grid-icon").toggleClass("diva-in-grid")},switchMode:function(){b(a.selector+"tools").toggleClass("diva-fullscreen-tools");a.inFullscreen?(b(a.selector+"tools-right").after(b(a.selector+"tools-left")),b(a.selector+"tools-left").addClass("in-fullscreen")):(b(a.selector+"tools-left").after(b(a.selector+
"tools-right")),b(a.selector+"tools-left").removeClass("in-fullscreen"))}}},ma=function(){if(window.divaPlugins){var c=[];b.each(window.divaPlugins,function(e,d){var u=d.pluginName[0].toUpperCase()+d.pluginName.substring(1);a["enable"+u]&&d.init(a,f)&&(u=d.titleText||u+" plugin","function"===typeof d.handleClick&&(c.push('<div class="diva-'+d.pluginName+'-icon" title="'+u+'"></div>'),u=a.mobileWebkit?"touchend":"click",b(a.outerSelector).on(u,".diva-"+d.pluginName+"-icon",function(b){d.handleClick.call(this,
b,a)})),a.plugins.push(d))});c.length&&(a.pageTools='<div class="diva-page-tools">'+c.join("")+"</div>")}},ia=function(){clearTimeout(a.throbberTimeoutID);b(a.selector+"throbber").hide()},na=function(){var c='<div id="'+a.ID+'throbber" class="diva-throbber"></div>';b(a.outerSelector).append(c);a.throbberTimeoutID=setTimeout(function(){b(a.selector+"throbber").show()},a.throbberTimeout);b.ajax({url:a.objectData,cache:!0,dataType:"json",error:function(c,d,h){ia();c='<div id="'+a.ID+'error" class="diva-error"><p><strong>Error</strong></p><p>Invalid objectData. Error code: '+
d+" "+h+"</p>";0===a.objectData.lastIndexOf("http",0)&&""===h&&(h=a.objectData.replace(/https?:\/\//i,"").split(/[/?#]/)[0],location.hostname!==h&&(c+='<p>Attempted to access cross-origin data without CORS.</p><p>You may need to update your server configuration to support CORS. For help, see the <a href="https://github.com/DDMAL/diva.js/wiki/Installation#a-note-about-cross-site-requests" target="_blank">cross-site request documentation.</a></p>'));c+="</div>";b(a.outerSelector).append(c)},success:function(c,
d,h){ia();a.pages=c.pgs;a.maxRatio=c.dims.max_ratio;a.minRatio=c.dims.min_ratio;a.itemTitle=c.item_title;a.numPages=c.pgs.length;a.maxWidths=c.dims.max_w;a.maxHeights=c.dims.max_h;a.averageWidths=c.dims.a_wid;a.averageHeights=c.dims.a_hei;a.totalHeights=c.dims.t_hei;a.totalWidths=c.dims.t_wid;a.realMaxZoom=c.max_zoom;a.maxZoomLevel=0<=a.maxZoomLevel&&a.maxZoomLevel<=c.max_zoom?a.maxZoomLevel:c.max_zoom;a.minZoomLevel=0<=a.minZoomLevel&&a.minZoomLevel<=a.maxZoomLevel?a.minZoomLevel:0;a.zoomLevel=U(a.zoomLevel);
a.minPagesPerRow=Math.max(2,a.minPagesPerRow);a.maxPagesPerRow=Math.max(a.minPagesPerRow,a.maxPagesPerRow);a.enableFilename?(c=b.getHashParam("i"+a.hashParamSuffix),c=p(c)):c=parseInt(b.getHashParam("p"+a.hashParamSuffix),10)-1;s(c)&&(a.goDirectlyTo=c);b.each(a.plugins,function(b,c){g(c.setupHook,a)});a.enableToolbar&&(a.toolbar=la(),diva.Events.subscribe("VisiblePageDidChange",a.toolbar.updateCurrentPage),diva.Events.subscribe("ModeDidSwitch",a.toolbar.switchMode),diva.Events.subscribe("ViewDidSwitch",
a.toolbar.switchView),diva.Events.subscribe("ZoomLevelDidChange",a.toolbar.updateZoomSlider),diva.Events.subscribe("ZoomLevelDidChange",a.toolbar.updateZoomButtons),diva.Events.subscribe("GridRowNumberDidChange",a.toolbar.updateGridSlider),diva.Events.subscribe("ZoomLevelDidChange",a.toolbar.updateGridButtons));b(a.selector+"current label").text(a.numPages);a.enableAutoTitle&&b(a.parentSelector).prepend('<div id="'+a.ID+'title" class="diva-title">'+a.itemTitle+"</div>");b(a.parentSelector).parent()[0]!==
document.body||b(a.parentSelector).siblings().not("#diva-canvas-backdrop")[0]||(a.divaIsFullWindow=!0);a.mobileWebkit?V():(a.divaIsFullWindow?(a.widthProportion=b(a.parentSelector).width()/b(window).innerWidth(),a.heightProportion=Math.min(0.9,b(a.parentSelector).height()/b(window).innerHeight())):(a.widthProportion=b(a.parentSelector).width()/b(a.parentSelector).parent().innerWidth(),a.heightProportion=b(a.parentSelector).height()/b(a.parentSelector).parent().innerHeight()),W());a.enableAutoWidth&&
(a.mobileWebkit?(c=parseInt(b("body").css("margin")),b(a.outerSelector).css("margin-left",a.viewerWidthPadding-c)):b(a.outerSelector).css("margin-left",a.viewerWidthPadding));s(parseInt(a.goDirectlyTo),10)||(a.goDirectlyTo=0);c=parseInt(b.getHashParam("y"+a.hashParamSuffix),10);isNaN(c)?a.verticalOffset=P(!1):a.verticalOffset=c;c=parseInt(b.getHashParam("x"+a.hashParamSuffix),10);isNaN(c)?a.horizontalOffset=Q(!1):a.horizontalOffset=c;a.inFullscreen?X(!1):N();g(a.onReady,a);diva.Events.publish("ViewerDidLoad",
[a]);a.loaded=!0}})},Y=function(){return a.loaded?!0:(console.warn("The viewer is not completely initialized. This is likely because it is still downloading data. To fix this, only call this function if the isReady() method returns true."),!1)};(function(){a.scrollbarWidth=b.getScrollbarWidth();a.mobileWebkit=void 0!==window.orientation;a.ID=b.generateId("diva-");a.selector="#"+a.ID;var c=parseInt(a.ID,10);1<c&&(a.hashParamSuffix=c);a.outerSelector=a.selector+"outer";a.innerSelector=a.selector+"inner";
b(a.parentSelector).append('<div id="'+a.ID+'outer" class="diva-outer"></div>');b(a.outerSelector).append('<div id="'+a.ID+'inner" class="diva-inner diva-dragger"></div>');c=parseInt(b.getHashParam("n"+a.hashParamSuffix),10);c>=a.minPagesPerRow&&c<=a.maxPagesPerRow&&(a.pagesPerRow=c);c=b.getHashParam("z"+a.hashParamSuffix);""!==c&&(c=parseInt(c,10),c>=a.minZoomLevel&&(a.zoomLevel=c));var c=b.getHashParam("g"+a.hashParamSuffix),e="true"===c,d=b.getHashParam("f"+a.hashParamSuffix);a.inGrid=a.inGrid&&
"false"!==c||e;a.inFullscreen=a.inFullscreen&&"false"!==d||"true"===d;a.minHeight=parseInt(b(a.outerSelector).css("min-height"),10);a.minWidth=parseInt(b(a.outerSelector).css("min-width"),10);na();ma();ka()})();this.getItemTitle=function(){return a.itemTitle};this.gotoPageByNumber=function(a){a-=1;return s(a)?(S(a),!0):!1};this.gotoPageByIndex=function(a){return s(a)?(S(a),!0):!1};this.getCurrentPage=function(){console.warn("The call to getCurrentPage is deprecated. Use getCurrentPageIndex instead.");
return a.currentPageIndex};this.getNumberOfPages=function(){return Y()?a.numPages:!1};this.getPageDimensionsAtZoomLevel=function(b,c){if(!Y())return!1;c>a.maxZoomLevel&&(c=a.maxZoomLevel);var d=a.pages[b].d[parseInt(c,10)];return{width:d.w,height:d.h}};this.getCurrentPageDimensionsAtCurrentZoomLevel=function(){return this.getPageDimensionsAtZoomLevel(a.currentPageIndex,a.zoomLevel)};this.isReady=function(){return a.loaded};this.getCurrentPageIndex=function(){return a.currentPageIndex};this.getCurrentPageFilename=
function(){return a.pages[a.currentPageIndex].f};this.getCurrentPageNumber=function(){return a.currentPageIndex+1};this.getFilenames=function(){for(var b=[],c=0;c<a.numPages;c++)b[c]=a.pages[c].f;return b};this.getZoomLevel=function(){return a.zoomLevel};this.getMaxZoomLevel=function(){return a.maxZoomLevel};this.getMaxZoomLevelForPage=function(b){return Y?a.pages[b].m:!1};this.getMinZoomLevel=function(){return a.minZoomLevel};this.setZoomLevel=function(b){a.inGrid&&C();return M(b)};this.zoomIn=function(){return this.setZoomLevel(a.zoomLevel+
1)};this.zoomOut=function(){return this.setZoomLevel(a.zoomLevel-1)};this.inViewport=function(b,c,d){b=a.pageTopOffsets[b-1]+c;return n(b,b+d)};this.isPageInViewport=function(a){return y(a)};this.toggleFullscreenMode=function(){E()};this.enterFullscreenMode=function(){return a.inFullscreen?!1:(E(),!0)};this.leaveFullscreenMode=function(){return a.inFullscreen?(E(),!0):!1};this.toggleGridView=function(){C()};this.enterGridView=function(){return a.inGrid?!1:(C(),!0)};this.leaveGridView=function(){return a.inGrid?
(C(),!0):!1};this.gotoPageByName=function(a){a=p(a);return s(a)?(S(a),!0):!1};this.getPageIndex=function(a){return p(a)};this.getCurrentURL=function(){return ga()};this.getURLHash=function(){return fa()};this.getState=function(){return ea()};this.getInstanceSelector=function(){return a.selector};this.getInstanceId=function(){return a.ID};this.getSettings=function(){return a};this.translateFromMaxZoomLevel=function(b){return b/Math.pow(2,a.maxZoomLevel-a.zoomLevel)};this.translateToMaxZoomLevel=function(b){var c=
a.maxZoomLevel-a.zoomLevel;return 0===c?b:b*Math.pow(2,c)};this.setState=function(b){var c;c=p(b.i);s(c)?a.goDirectlyTo=c:s(b.p)&&(a.goDirectlyTo=b.p);a.horizontalOffset=parseInt(b.x,10);a.verticalOffset=parseInt(b.y,10);b.z>=a.minZoomLevel&&b.z<=a.maxZoomLevel&&(a.zoomLevel=b.z);b.n>=a.minPagesPerRow&&b.n<=a.maxPagesPerRow&&(a.pagesPerRow=b.n);a.inFullscreen!==b.f?(a.inFullscreen=b.f,X(a.inGrid!==b.g)):a.inGrid!==b.g?(a.inGrid=b.g,B()):N()};this.enableScrollable=function(){a.isScrollable||(ha(),
a.enableKeyScroll=a.initialKeyScroll,a.enableSpaceScroll=a.initialSpaceScroll,b(a.outerSelector).css("overflow","auto"),a.isScrollable=!0)};this.disableScrollable=function(){a.isScrollable&&(b(a.innerSelector+".diva-dragger").unbind("mousedown"),b(a.outerSelector).unbind("dblclick"),b(a.outerSelector).unbind("contextmenu"),b(a.outerSelector).css("overflow","hidden"),a.initialKeyScroll=a.enableKeyScroll,a.initialSpaceScroll=a.enableSpaceScroll,a.enableKeyScroll=!1,a.enableSpaceScroll=!1,a.isScrollable=
!1)};this.destroy=function(){b("body").removeClass("diva-hide-scrollbar");b(a.parentSelector).empty().removeData("diva");b.each(a.plugins,function(b,c){g(c.destroy,a,f)});b(a.parentSelector).removeAttr("style").removeAttr("class");diva.Events.unsubscribeAll()}};b.fn.diva=function(d){return this.each(function(){var c=b(this);if(!c.data("diva")){d.parentSelector=c;var a=new f(this,d);c.data("diva",a)}})}})(jQuery);(function(b){window.divaPlugins.push(function(){var f={},d={},c={},a,k,g,l={brightnessMax:150,brightnessMin:-100,brightnessStep:1,contrastMax:3,contrastMin:-1,contrastStep:0.05,localStoragePrefix:"canvas-",mobileWebkitMaxZoom:2,onInit:null,rgbMax:50,rgbMin:-50,throbberFadeSpeed:200,throbberTimeout:100,buttons:["contrast","brightness","rotation","zoom"]},p=function(b,c){var d=b.context,f=b.size/2,k=-(b.width/2),g=-(b.height/2);d.clearRect(0,0,b.size,b.size);d.save();d.translate(f,f);d.rotate(c*Math.PI/
180);d.drawImage(a,k,g,b.width,b.height);d.restore();b.data=d.getImageData(0,0,b.size,b.size)},t=function(){for(var a in k)if(k[a].current!==k[a].previous)return!0;return!1},n=function(){p(d,k.rotation.current);L(d)},s=function(){var a=k.rotation.current,d=k.zoom.current,g=k.zoom.previous;if(a!==k.rotation.previous||d!==g){var r=b("#diva-canvas-wrapper").scrollLeft(),l=b("#diva-canvas-wrapper").scrollTop(),m=c.viewport.width/2,n=c.viewport.height/2,r=r+m-f.centerX,q=-(l+n-f.centerY),G=(k.rotation.previous-
a)*Math.PI/180,l=Math.cos(G)*r-Math.sin(G)*q+f.centerX,r=-(Math.sin(G)*r+Math.cos(G)*q)+f.centerY,d=Math.pow(2,d-g),m=d*l-m,n=d*r-n;p(f,a);b("#diva-canvas-wrapper").scrollLeft(m);b("#diva-canvas-wrapper").scrollTop(n)}if(t()){L(f);for(var I in k)k[I].previous=k[I].current}},y=function(a){var b=k[a].current!==k[a].initial;return k[a].current!==k[a].previous||b},L=function(a){var b=a.data,d=a.context.createImageData(b),f=d.data,g,l;g=0;for(l=f.length;g<l;g++)f[g]=b.data[g];b=d.data;g=k.contrast.current;
f=(1+Math.min(c.brightnessMax,Math.max(c.brightnessMin,k.brightness.current))/c.brightnessMax)*g;g=128-128*g;l=k.red.current;var m=k.green.current,n=k.blue.current,G=y("red"),p=y("green"),q=y("blue"),s=y("brightness"),t=y("contrast"),s=s||t,w,v,z,x,B,E,C,t=0;for(v=d.width;t<v;t++)for(w=0,z=d.height;w<z;w++)x=4*(w*v+t),B=b[x],E=b[x+1],C=b[x+2],0<B+E+C&&(G&&B&&(B+=l),p&&E&&(E+=m),q&&C&&(C+=n),s&&(B&&(B=B*f+g),E&&(E=E*f+g),C&&(C=C*f+g)),b[x]=B,b[x+1]=E,b[x+2]=C);a.context.clearRect(0,0,v,z);a.context.putImageData(d,
0,0)},m=function(){var a=b("#diva-canvas-wrapper").scrollLeft()*d.scaleFactor,f=b("#diva-canvas-wrapper").scrollTop()*d.scaleFactor,k=Math.min(Math.round(c.viewport.height*d.scaleFactor),c.mapSize)-4,g=Math.min(Math.round(c.viewport.width*d.scaleFactor),c.mapSize)-4;b("#diva-map-viewbox").height(k).width(g).css({top:f,left:a})},O=function(k,g){a=new Image;a.src=k;a.crossOrigin="Anonymous";a.onload=function(){f.size=Math.sqrt(a.width*a.width+a.height*a.height);f.canvas=document.getElementById("diva-canvas");
f.canvas.width=f.size;f.canvas.height=f.size;f.cornerX=(f.size-a.width)/2;f.cornerY=(f.size-a.height)/2;f.width=a.width;f.height=a.height;f.centerX=f.size/2;f.centerY=f.size/2;f.context=f.canvas.getContext("2d");f.context.drawImage(a,f.cornerX,f.cornerY,f.width,f.height);try{f.data=f.context.getImageData(0,0,f.size,f.size)}catch(k){var l='<div id="diva-error" class="diva-error"><p><strong>Error</strong></p><p>'+k.message+"</p>";if("SecurityError"!==k.name)throw k;l+='<p>You may need to update your server configuration in order to use the image manipulation tools. For help, see the <a href="https://github.com/DDMAL/diva.js/wiki/The-API-and-Plugins#a-note-about-canvas-and-cross-site-data" target="_blank">canvas cross-site data documentation</a>.</p></div></div>';
b("#diva-canvas-backdrop").append(l);z()}void 0===g&&(l=a,d.canvas=document.getElementById("diva-canvas-minimap"),d.size=c.mapSize,d.canvas.width=d.size,d.canvas.height=d.size,d.context=d.canvas.getContext("2d"),d.context.fillRect(0,0,d.size,d.size),d.scaleFactor=c.mapSize/f.size,d.cornerX=f.cornerX*d.scaleFactor,d.cornerY=f.cornerY*d.scaleFactor,d.width=l.width*d.scaleFactor,d.height=l.height*d.scaleFactor,d.context.drawImage(l,d.cornerX,d.cornerY,d.width,d.height),d.data=d.context.getImageData(0,
0,c.mapSize,c.mapSize),b("#diva-map-viewbox").show(),m());n();s(f);z();"function"===typeof g&&g.call(g)}},K=function(){var a=k[g],c=a.current,a=a.transform?a.transform(c):c;b("#diva-canvas-value").html(a)},q=function(){b("#diva-canvas-slider").val(k[g].current)},v=function(a){a=c.zoomWidthRatio*Math.pow(2,a);return c.proxyURL?c.proxyURL+"?f="+c.filename+"&w="+a:c.iipServerURL+"?FIF="+(c.imageDir+"/")+c.filename+"&WID="+a+"&CVT=JPEG"},w=function(){(0<k.zoom.current||c.mobileWebkit)&&b(c.selector+"throbber").addClass("canvas-throbber").show()},
z=function(){b(c.selector+"throbber").removeClass("canvas-throbber").hide()},H=function(){var a={},b=!1,d=c.localStoragePrefix+c.filename,f;for(f in k)k[f].previous!==k[f].initial&&(a[f]=k[f].previous,b=!0);b?(c.pluginIcon.addClass("new"),localStorage.setObject(d,a)):(c.pluginIcon.removeClass("new"),localStorage.removeItem(d))},x=function(a,b){c.zoomLevel=a;var k=v(a);O(k,function(){d.scaleFactor=d.size/f.size;m();H()})};return{init:function(a,p){if(!window.HTMLCanvasElement)return!1;b.extend(c,l,
a.canvasPlugin);c.inCanvas=!1;c.iipServerURL=a.iipServerURL;c.imageDir=a.imageDir;c.selector=a.selector;c.mobileWebkit=a.mobileWebkit;k={contrast:{initial:1,min:c.contrastMin,max:c.contrastMax,step:c.contrastStep,transform:function(a){return a.toFixed(2)},title:"Change the contrast"},brightness:{initial:0,min:c.brightnessMin,max:c.brightnessMax,step:c.brightnessStep,title:"Adjust the brightness"},rotation:{initial:0,min:0,max:359,step:1,transform:function(a){return a+"&deg;"},title:"Rotate the image"},
zoom:{initial:0,min:0,max:0,step:1,title:"Adjust the zoom level"},red:{initial:0,min:c.rgbMin,max:c.rgbMax,step:1,title:"Adjust the red channel"},green:{initial:0,min:c.rgbMin,max:c.rgbMax,step:1,title:"Adjust the green channel"},blue:{initial:0,min:c.rgbMin,max:c.rgbMax,step:1,title:"Adjust the blue channel"}};var A=function(){var a,b,c;for(c in k)b=k[c],a=b.initial,b.current=a,b.previous=a};A();if(b("#diva-canvas-backdrop").length)return!0;var r=[],v,D,J;for(J in c.buttons)v=c.buttons[J],D=k[v].title,
v='<div class="'+v+'" title="'+D+'"></div>',r.push(v);r='<div id="diva-canvas-backdrop">'+('<div id="diva-canvas-tools"><div id="diva-canvas-toolbar"><div id="diva-canvas-close" title="Return to the document viewer"></div><div id="diva-canvas-minimise" title="Minimise the toolbar"></div><span id="diva-canvas-info">Test</span></div><div id="diva-canvas-toolwindow"><div id="diva-map-viewbox"></div><canvas id="diva-canvas-minimap"></canvas><div id="diva-canvas-buttons">'+r.join("")+'</div><div id="diva-canvas-pane"><p id="diva-canvas-tooltip"><span id="diva-canvas-mode">contrast</span>: <span id="diva-canvas-value">0</span> <span id="diva-canvas-reset" class="link">(Reset)</span></p><input type="range" id="diva-canvas-slider"></input></div><br /><div class="action-buttons"><a href="#" id="diva-canvas-reset-all">Reset all</a><a href="#" id="diva-canvas-apply">Apply</a></div></div></div>')+
'<div id="diva-canvas-wrapper"><canvas id="diva-canvas"></canvas></div></div>';b("body").append(r);c.mapSize=b("#diva-canvas-minimap").width();b("#diva-canvas-buttons div").click(function(){b("#diva-canvas-buttons .clicked").removeClass("clicked");y(b(this).attr("class"))});var y=function(a){g=a;a=k[g];b("#diva-canvas-buttons ."+g).addClass("clicked");b("#diva-canvas-mode").text(g);var c=a.current,d=a.transform?a.transform(c):c,f=document.getElementById("diva-canvas-slider");f.min=a.min;f.max=a.max;
f.step=a.step;b("#diva-canvas-slider").val(c);b("#diva-canvas-value").html(d)};y("contrast");b("#diva-canvas-slider").on("input",function(a){k[g].current=parseFloat(this.value);K();n()});b("#diva-canvas-reset-all").click(function(){for(var a in k)k[a].current=k[a].initial;K();q();n()});b("#diva-canvas-reset").click(function(){k[g].current=k[g].initial;K();q();n()});b("#diva-canvas-apply").click(function(){t()&&(w(),setTimeout(function(){k.zoom.current!==k.zoom.previous?x(k.zoom.current):(s(),z(),
H())},c.throbberTimeout))});b("#diva-canvas-close").click(function(){b("body").removeClass("overflow-hidden");f.context.clearRect(0,0,f.size,f.size);d.context.clearRect(0,0,d.size,d.size);b("#diva-canvas-wrapper").scrollTop(0).scrollLeft(0);b("#diva-canvas-backdrop").hide();b("#diva-map-viewbox").hide();z();A();K();q();b("#diva-canvas-buttons .clicked").removeClass("clicked");y("contrast");diva.Events.publish("CanvasViewDidHide")});b("#diva-canvas-minimise").click(function(){b("#diva-canvas-toolwindow").slideToggle("fast")});
b(window).resize(function(){c.viewport={height:window.innerHeight-a.scrollbarWidth,width:window.innerWidth-a.scrollbarWidth};c.inCanvas&&m()});b("#diva-canvas-wrapper").scroll(function(){c.inCanvas&&m()});b("#diva-canvas-minimap, #diva-map-viewbox").mouseup(function(a){var f=b("#diva-canvas-minimap").offset(),k=(a.pageX-f.left)/d.scaleFactor;a=(a.pageY-f.top)/d.scaleFactor;b("#diva-canvas-wrapper").scrollTop(a-c.viewport.height/2);b("#diva-canvas-wrapper").scrollLeft(k-c.viewport.width/2)});b("#diva-canvas").mousedown(function(){b(this).addClass("grabbing")}).mouseup(function(){b(this).removeClass("grabbing")});
c.mobileWebkit?b("#diva-canvas-wrapper").kinetic():b("#diva-canvas-wrapper").dragscrollable({acceptPropagatedEvent:!0});"function"===typeof c.onInit&&c.onInit.call(this,c);return!0},pluginName:"canvas",titleText:"View the image on a canvas and adjust various settings",setupHook:function(a){c.viewport={height:window.innerHeight-a.scrollbarWidth,width:window.innerWidth-a.scrollbarWidth};c.minZoomLevel=a.minZoomLevel;c.maxZoomLevel=a.maxZoomLevel;c.mobileWebkit&&(c.maxZoomLevel=Math.min(c.maxZoomLevel,
c.mobileWebkitMaxZoom));k.zoom.min=c.minZoomLevel;k.zoom.max=c.maxZoomLevel},handleClick:function(a,d){var f=b(this).parent().parent(),l=b(f).attr("data-filename"),m=b(f).width()-1,n=d.zoomLevel,p;c.zoomWidthRatio=m/Math.pow(2,n);c.pluginIcon=b(this);c.mobileWebkit&&(n=Math.min(c.maxZoomLevel,n));c.filename=l;k.zoom.initial=n;k.zoom.current=n;if(l=localStorage.getObject(c.localStoragePrefix+c.filename))for(p in l)k[p].current=l[p],p===g&&(K(),q()),"zoom"===p&&(n=l[p]);k.zoom.previous=n;b("body").addClass("overflow-hidden");
b("#diva-canvas-backdrop").show();c.inCanvas=!0;n=v(n);b("#diva-canvas-info").text(b(f).attr("title"));w();diva.Events.publish("CanvasViewDidActivate",[f]);O(n)},onPageLoad:function(a,d,f){null!==localStorage.getItem(c.localStoragePrefix+d)&&b(f).find(".diva-canvas-icon").addClass("new")},destroy:function(a,c){b("#diva-canvas-backdrop").remove()}}}())})(jQuery);(function(b){window.divaPlugins.push(function(){var f,d;return{init:function(b,a){f=b.iipServerURL;d=b.imageDir;return!0},pluginName:"download",titleText:"Download image at the given zoom level",handleClick:function(c){var a=b(this).parent().parent();c=b(a).attr("data-filename");a=b(a).width()-1;window.open(f+"?FIF="+(d+"/")+c+"&WID="+a+"&CVT=JPEG")}}}())})(jQuery);(function(b){window.divaPlugins.push(function(){return{init:function(b,d){function c(a,c,g){var l=b.parentSelector.data("highlights");if("undefined"!==typeof l){if(l.hasOwnProperty(a)){c=d.getInstanceId()+"page-"+a;c=document.getElementById(c);g=l[a].regions;var p=l[a].colour;a=l[a].divClass;for(var l=d.getMaxZoomLevel()-d.getZoomLevel(),t=g.length;t--;){var n=document.createElement("div");n.style.width=g[t].width/Math.pow(2,l)+"px";n.style.height=g[t].height/Math.pow(2,l)+"px";n.style.top=g[t].uly/
Math.pow(2,l)+"px";n.style.left=g[t].ulx/Math.pow(2,l)+"px";n.style.background=p;n.style.border="1px solid #555";n.style.position="absolute";n.style.zIndex=100;n.className=a;"undefined"!==typeof g[t].divID&&(n.id=g[t].divID);c.appendChild(n)}}diva.Events.publish("HighlightCompleted")}}b.parentSelector.data("highlights",{});diva.Events.subscribe("PageWillLoad",c);d.resetHighlights=function(){for(var a=document.getElementById(b.ID+"inner").getElementsByClassName(b.ID+"highlight"),c=a.length;c--;)a[c].parentNode.removeChild(a[c]);
b.parentSelector.data("highlights",{})};d.removeHighlightsOnPage=function(a){var c=b.parentSelector.data("highlights");if(c.hasOwnProperty(a)){for(var g=d.getInstanceId()+"page-"+a,g=document.getElementById(g),l=g.getElementsByTagName("div"),p=c[a].divClass,t=l.length;t--;)l[t].className===p&&g.removeChild(l[t]);delete c[a]}};d.highlightOnPages=function(a,b,c,f){for(var p=a.length;p--;)d.highlightOnPage(a[p],b,c,f)};d.highlightOnPage=function(a,k,g,l){"undefined"===typeof g&&(g="rgba(255, 0, 0, 0.2)");
l="undefined"===typeof l?b.ID+"highlight":b.ID+"highlight "+l;d.getMaxZoomLevel();b.parentSelector.data("highlights")[a]={regions:k,colour:g,divClass:l};d.isPageInViewport(a)&&c(a,null,null);return!0};return!0},destroy:function(b,d){b.parentSelector.removeData("highlights")},pluginName:"highlight",titleText:"Highlight regions of pages"}}())})(jQuery);(function(b){window.divaPlugins.push(function(){return{init:function(b,d){return!0},pluginName:"text",titleText:"View the text of this page"}}())})(jQuery);
